---

test_name: Test files can be uploaded with tavern

includes:
  - !include common.yaml

stages:
  - name: Upload multiple files
    request:
      url: "{host}/fake_upload_file"
      method: POST
      files:
        test_files: "test_files.tavern.yaml"
        common: "common.yaml"
    response:
      status_code: 200

---

test_name: Test extra headers don't break content-type

includes:
  - !include common.yaml

stages:
  - name: Upload multiple files with custom headers
    request:
      url: "{host}/fake_upload_file"
      method: POST
      headers:
        x-test-header: chorp
      files:
        test_files: "test_files.tavern.yaml"
        common: "common.yaml"
    response:
      status_code: 200

---

test_name: Test content-type header ignored when sending files

includes:
  - !include common.yaml

stages:
  - name: Try to override content-type when sending files
    request:
      url: "{host}/fake_upload_file"
      method: POST
      headers:
        content-type: application/json
        x-custom-header: test
      files:
        test_files: "test_files.tavern.yaml"
    response:
      status_code: 200
